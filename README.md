# spatial_computer_vision
Tools for converting between large-format spatial imagery and non-spatial tiles for computer vision

tile_orthomosaic splits a large-format spatial image into small tiles of a specified dimension, with a specified overlap between adjacent tiles, while preserving spatial metadata in a json file (default name: tiling_scheme.json) that can be used to reintegrate data from the unreferenced tiles into a spatially referenced dataset.

global_annotations_to_tile reads in a CSV of points with lat/lon coordinates, buffers the points into boxes, then partitions the boxes to their appropriate tiles using tiling_scheme.json. The output annotations are provided in a format that can be read into VGG Image Annotator (https://www.robots.ox.ac.uk/~vgg/software/via/). Script inputs could easily be modified to receive a shapefile or KML instead of a CSV, and script outputs could easily be modified to yield an alternative annotation format.

tile_annotations_to_global reads in annotations - as might be generated during manual image annotation or from a computer vision output - in VGG Image Annotator format and collates them into a spatially referenced dataset. Redundant annotations can occur due to overlap between tiles or due to permissive parameters in a computer vision output, and we remove such redundancies using non-max suppression techniques on a within-class basis. These techniques involve threshold parameters that can be customized in-script to determine which annotations are discarded, though we assign values that have worked for us so far. We recommend that users inspect the files that result from this script to ensure that they do not include redundancies nor are they omitting important data points. Manual corrections may be required after NMS. Certain instances that entail high overlap among adjacent annotations (e.g. animals in coitus) might not be effectively distinguished by NMS and might require a single annotation of a distinct class. The input annotations expect the format of a VGG Image Annotator CSV, and the output annotations are provided as a shapefile. Note the comments of the last cell: GDAL and the Fiona tool do not always play well in their latest versions, at the time this was written. I was able to use a custom python environment to reconcile these issues, but your mileage may vary depending on your system. As usual, script inputs could easily be modified to ingest alternative annotation formats, and script outputs could be easily modified to yield an alternate export filetype or method - this might be preferable if you are unable to set up a viable Fiona installation on your system.

Please direct any questions or comments to gl7176@gmail.com and I will assist if able!
